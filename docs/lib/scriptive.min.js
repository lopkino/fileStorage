/*!
    scriptive -- Javascript application service
    v1.0.1
    https://scriptive.github.io/core
    (c) 2016
*/
Object.defineProperty(Object.prototype,"each",{enumerable:!1,value:function(callback){var a={object:function(o){var s=0,l=Object.keys(o).length;for(var i in o)s++,o.hasOwnProperty(i)&&callback(i,o[i],o,s==l)},array:function(o){for(var l=o.length,i=0;i<l;i++)callback(i,o[i],o,i==l-1)}};return a[this.constructor===Object?"object":"array"](this)}}),Object.defineProperties(Object.prototype,{merge:{value:function(){for(var s,a=arguments,o=0,len=a.length;o<len;o++)if(a[o].isObject())for(var i in a[o])try{s?this.hasOwnProperty(i)?this[i].isArray()||a[o][i].isArray()?this[i]=this[i].merge(a[o][i]):this[i].merge(s,a[o][i]):this[i]=a[o][i]:this[i].isArray()||this[i].isObject()?this[i]=this[i].merge(a[o][i]):this[i]=a[o][i]}catch(e){this[i]=a[o][i]}else 0===o&&(s=a[o]);return this}},hasMethodProperty:{value:function(o){return this.hasOwnProperty(o)&&this.isFunction(o)}},isEmpty:{value:function(){return this.isObject()?0===Object.keys(this).length:this.isArray()?this.length:void 0}},isFunction:{value:function(o){return o?"function"==typeof this[o]:this.constructor===Function}},isNumeric:{value:function(o){return o?this.hasOwnProperty(o)&&!isNaN(parseFloat(this[o]))&&isFinite(this[o]):!isNaN(parseFloat(this))&&isFinite(this)}},isObject:{value:function(){return this.constructor===Object}},isArray:{value:function(){return this.constructor===Array}},count:{value:function(){return Object.keys(this).length}},paramater:{value:function(url){var o=this;return url?url.isArray()||(url=[url]):url=[],url.push(Object.keys(o).reduce(function(a,k){return a.push(k+"="+encodeURIComponent(o[k])),a},[]).join("&")),url.toSentence("/","?")}},eventHandler:{value:function(handler,callback,status){this.hasOwnProperty(handler)||(this.addEventListener(handler,callback,status),this[handler]=!0)}}}),Object.defineProperties(Array.prototype,{remove:{value:function(){for(var item,x,o=arguments,i=o.length;i&&this.length;)for(item=o[--i];(x=this.indexOf(item))!==-1;)this.splice(x,1);return this}},merge:{value:function(o){return this.concat(o).filter(function(item,index,o){return o.indexOf(item)===index})}},unique:{value:function(){return this.filter(function(item,index,o){return o.indexOf(item)===index})}},has:{value:function(o){if(this.indexOf(o)>-1)return o;for(i=0;i<this.length;i++)if(this[i]==o)return o}},toSentence:{value:function(y,x){return this.length>1?[this.slice(0,-1).join(y||", "),this.slice(-1)[0]].join(x||" & "):this.join()}}}),function(os,win,doc){"use strict";var ob="app",obUnique=":unique",Config={},app={todo:{1:"a"},init:function(a){var id=typeof a;if(app.fn.hasOwnProperty(id))return app.fn[id](a)},ready:function(callback){doc.addEventListener("DOMContentLoaded",callback,!1)},fn:{object:function(o){return app.root.merge(o)},string:function(n){return ob=n,win[n]=app.root}},callback:{before:function(e){return e},progress:function(e){return e},done:function(e){return e},fail:function(e){return e},success:function(e){return e}},device:{platform:{is:function(needle){return navigator.userAgent.toLowerCase().indexOf(needle)!==-1},ios:function(){return this.iphone()||this.ipod()||this.ipad()},iphone:function(){return!this.windows()&&this.is("iphone")},ipod:function(){return this.is("ipod")},ipad:function(){return this.is("ipad")},android:function(){return!this.windows()&&this.is("android")},ADP:function(){return this.android()&&this.is("mobile")},ADT:function(){return this.android()&&!this.is("mobile")},blackberry:function(){return this.is("blackberry")||this.is("bb10")||this.is("rim")},BBP:function(){return this.blackberry()&&!this.is("tablet")},BBT:function(){return this.blackberry()&&this.is("tablet")},windows:function(){return this.is("windows")},WDP:function(){return this.windows()&&this.is("phone")},WDT:function(){return this.windows()&&this.is("touch")&&!this.WDP()},fxos:function(){return(this.is("(mobile;")||this.is("(tablet;"))&&this.is("; rv:")},FFP:function(){return this.fxos()&&this.is("mobile")},FFT:function(){return this.fxos()&&this.is("tablet")},meego:function(){return this.is("meego")},cordova:function(){return win.cordova&&"file:"===location.protocol},chrome:function(){return"chrome"===Config.Platform},nodeWebkit:function(){return"object"==typeof window.process},mobile:function(){return this.ADP()||this.iphone()||this.ipod()||this.WDP()||this.BBP()||this.FFP()||this.meego()},tablet:function(){return this.ipad()||this.ADT()||this.BBT()||this.WDT()||this.FFT()}},agent:function(fileMeta){var fileAgent=[],fileTemplate=[],name={desktop:"desktop",tablet:"tablet",mobile:"mobile",ios:"ios",android:"android",defaults:"default",web:"web",app:"app"};if(Config.isCordova=this.platform.cordova(),Config.isChrome=this.platform.chrome(),Config.Platform||(Config.Platform=name.web),Config.Screen||(Config.Screen=name.desktop),this.platform.mobile()?Config.Screen=name.mobile:this.platform.tablet()&&(Config.Screen=name.tablet),this.platform.ios()?Config.Device=name.ios:this.platform.android()?Config.Device=name.android:this.platform.hasMethodProperty(Config.Device)||(Config.Device=name.defaults),"object"==typeof Config.DeviceAgent)for(var i in Config.DeviceAgent){var iName=Config.DeviceAgent[i];Config.hasOwnProperty(iName)?fileAgent.push(Config[iName]):"string"==typeof iName&&fileAgent.push(iName)}else fileAgent.push(Config.Platform,Config.Screen,Config.Device);if("object"==typeof Config.DeviceTemplate)for(var i in Config.DeviceTemplate){var iName=Config.DeviceTemplate[i];Config.hasOwnProperty(iName)?fileTemplate.push(Config[iName]):"string"==typeof iName&&fileTemplate.push(iName)}else Config.Platform==name.web?fileTemplate.push(name.defaults,Config.Screen):fileTemplate.push(Config.Device,Config.Screen);Config.DeviceTemplate=fileTemplate;var file=[],fileName=[];if("object"==typeof fileMeta)for(var id in fileAgent){fileName.push(fileAgent[id]);for(var fileType in fileMeta)fileMeta.hasOwnProperty(fileType)&&"object"==typeof fileMeta[fileType]&&fileMeta[fileType].filter(function(i){return i==id}).length&&file.push({type:fileType,name:fileName.join(".")})}return file},orientate:function(evt){win.addEventListener?win.addEventListener(evt,this.setAttribute,!1):win.attachEvent?win.attachEvent(evt,this.setAttribute):win[evt]=this.setAttribute,this.setAttribute()},setAttribute:function(){doc.querySelector(Config.Orientation.html).setAttribute("class",win.innerHeight<win.innerWidth?Config.Orientation.landscape:Config.Orientation.portrait)}},hash:function(){var q,r=this.root.config.hash,o=win.location.hash.split("?");if(o.length){for(var hash=o[0].split("/"),i=0;i<hash.length;i++)hash[i]&&(0==i?r.page=hash[i].replace(/#/,""):r[i]=hash[i]);if(o.length>1)for(var search=/([^\?#&=]+)=([^&]*)/g;q=search.exec(o[1]);)r[q[1]]=q[2]}return r},idUnique:function(id){"string"==typeof id?id.search(obUnique)<0?this.root.config.idUnique=id+obUnique:this.root.config.idUnique=id:this.root.config.idUnique=ob+obUnique},data:{execute:function(x,y){var i=x.shift();if(this.hasOwnProperty(i)){if(this.isFunction(i))return this[i](y);if(x.length)return app.data.execute.call(this[i],x,y)}return!1},link:function(selector){doc.querySelectorAll("[0]".replace(0,selector)).each(function(i,element){element.hasOwnProperty(app.root.config.Handler)||element.addEventListener(app.root.config.Handler,function(event){var query=element.getAttribute(selector).split(" ").filter(function(e){return e});app.data.execute.call(app.root,query,element)},!1),element[app.root.config.Handler]=!0})},content:function(selector){doc.querySelectorAll("[0]".replace(0,selector)).each(function(i,element){var query=element.getAttribute(selector).split(" ").filter(function(e){return e});app.data.execute.call(app.root,query,element)})}},meta:{locale:{script:{attr:{src:null},extension:".js",dir:"js/"},link:{attr:{rel:"stylesheet",href:null},extension:".css",dir:"css/"}},oblige:function(fileMeta){var file=[];for(var type in fileMeta)for(var src in fileMeta[type])file.push({type:type,name:fileMeta[type][src].toString().replace(" ",".")});return file},append:function(deviceAgent){delete Config.Meta.agent,Config.Meta=this.oblige(Config.Meta).concat(deviceAgent),this.attach()},attach:function(){try{var o=this,x=Config.Meta.shift(),y=x.type,url=(x.dir||o.locale[y].dir)+x.name+o.locale[y].extension,req=doc.createElement(y);o.locale[y].attr.each(function(i,v){req[i]=v||url}),req.onerror=function(){o.attach()},req.onload=function(){app.root.notification(x.name),Config.Meta.length?o.attach():o.listen()},doc.head.appendChild(req)}catch(e){this.listen()}},listen:function(){Config.isCordova?(app.root.notification("class","icon-database").innerHTML="getting Device ready...",doc.addEventListener("deviceready",this.initiate,!1)):this.initiate()},initiate:function(){Config.Execute.each(function(i,v){i="object"==typeof v?Object.keys(v)[0]:v,app.data.execute.call(app.root,i.split(" "),v[i])})}},root:{config:{Meta:{agent:{script:[0,1,2],link:[0,1,2]}},Execute:["initiate"],Handler:"ontouchstart"in document.documentElement?"touchstart":"click",On:"fO",dataLink:"data-link",dataContent:"data-content",Screen:"desktop",Platform:"web",Layout:null,Browser:"chrome",Orientation:{change:"D1699",landscape:"landscape",portrait:"portrait",html:"html"},hash:{},todo:{Orientation:!0},container:{},msg:{info:"#msg"},name:"app",version:"undefined",build:"undefined"},scriptive:{version:"1.0.1.2017.01.28"},document:function(response){response.merge({config:{}}),Config=this.config.merge(response.config),app.ready(function(event){response.hasOwnProperty("ready")&&response.ready.call(app.root,event),"string"==typeof Config.msg.info&&(Config.msg.info=doc.querySelector(Config.msg.info)),app.idUnique(Config.id),"object"==typeof Config.Orientation&&app.device.orientate(Object.prototype.hasOwnProperty.call(window,"onorientationchange")?"orientationchange":"resize"),"object"==typeof Config.Meta?app.meta.append(app.device.agent(Config.Meta.agent)):app.meta.listen(),app.root.Observer=new MutationObserver(function(mutations){app.root.dataLink()}),app.root.Observer.observe(doc.body,{attributes:!0,subtree:!0})})},notification:function(){if(null!==this.config.msg.info)return arguments.length>1?this.config.msg.info.setAttribute(arguments[0],arguments[1]):this.config.msg.info.innerHTML=arguments[0],this.config.msg.info},dataExecute:function(x,y){return app.data.execute.call(this,x,y)},dataLink:function(d){app.data.link(d?d:this.config.dataLink)},dataContent:function(d){app.data.content(d?d:this.config.dataContent)},metaLink:function(){arguments[0].each(function(i,v){win[v]=doc.querySelector("link[rel=0]".replace(0,v)).getAttribute("href")})},metaContent:function(){arguments[0].each(function(i,v){win[v]=doc.querySelector("meta[name=0]".replace(0,v)).getAttribute("content")})},localStorage:{name:{},storage:win.localStorage,select:function(key,val){var val=this.storage.getItem(this.ids(key));try{this.name[key]=val?JSON.parse(val):{}}catch(e){this.name[key]=val}finally{return this}},insert:function(key,val){var id=this.ids(key);return"object"==typeof val?this.storage.setItem(id,JSON.stringify(val)):this.storage.setItem(id,val),this.name[key]=val,this},update:function(key,val){return this.insert(key,val||this.name[key])},delete:function(key){return this.storage.removeItem(this.ids(key)),this},ids:function(key){return app.root.config.idUnique.replace(/unique/,key)}},hashChange:function(callback){return win.addEventListener("hashchange",function(event){app.hash(),"function"==typeof callback&&callback(event)},!1),app.hash()},load:function(file){return file.merge(!0,app.callback),new Promise(function(resolve,reject){var xmlHttp=win.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),Percentage=0;xmlHttp.addEventListener("progress",function(e){Percentage++,e.lengthComputable?(Percentage=Math.floor(e.loaded/e.total*100),file.progress(Percentage)):xmlHttp.readyState==XMLHttpRequest.DONE?file.progress(100):200!=xmlHttp.status&&(file.progress(Math.floor(Percentage/7*100)),Percentage++)},!1),xmlHttp.addEventListener("load",function(e){200==xmlHttp.status?resolve(xmlHttp):reject(xmlHttp.statusText?file.fileUrl?{message:xmlHttp.statusText+" : "+file.fileUrl,code:xmlHttp.status}:{message:xmlHttp.statusText,code:xmlHttp.status}:xmlHttp.status?{message:"Error",code:xmlHttp.status}:{message:"Unknown Error",code:0})},!1),xmlHttp.addEventListener("error",reject,!1),xmlHttp.addEventListener("abort",reject,!1);try{xmlHttp.open(file.requestMethod?file.requestMethod:"GET",file.fileUrl,!0),file.before(xmlHttp),xmlHttp.send()}catch(e){reject({message:e.name,code:1})}finally{}}).then(function(e){return file.success(e)},function(e){return file.fail(e)}).then(function(e){return file.done(e)})}}};win[os]=function(a){return new app.init(a)}}("scriptive",window,document);